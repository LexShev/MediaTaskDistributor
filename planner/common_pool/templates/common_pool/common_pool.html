{% extends  'main/index.html' %}
{% load static %}
<main>

{% block body %}

<div class="container-xxl text-start p-0">
    <br><h3>Общий пул</h3>
    <h6>Материалов в базе не отсмотрено: <span id="total-count">Загрузка...</span></h6>
    <h6>Из них фильмов: <span id="film-count">Загрузка...</span></h6>
    <h6>Из них сериалов: <span id="season-count">Загрузка...</span></h6>
    <br>
    <form method="POST" id="poolForm">
        {% csrf_token %}
        <div class="input-group mb-3">
            <label class="input-group-text" for="search_type">Поиск по</label>
            {{ form.search_type }}
            {{ form.search_input }}
            {{ form.sql_set }}
            <button type="submit" class="btn btn-outline-secondary">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
              </svg>
            </button>
        </div>
    </form>

    <div class="modal fade" id="errorModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Ошибка!</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <h6 id="error_message"></h6>
            <div class="border rounded mb-4" style="display: none; overflow-y: auto; max-height: 60rem;" id="errors_container">
                <ol class="list-group list-group-flush list-group-numbered list-group-item-action" id="errors_list">
                </ol>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="ApproveCommonTask" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" id="approve_title"></h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
              <div class="border rounded mb-4" style="overflow-y: auto; max-height: 50rem;">
                <ol class="list-group list-group-flush list-group-numbered list-group-item-action" id="program_name_list">
                </ol>
              </div>
            <h5 id="approve_date_title"></h5>
            <input type="date" name="work_date" value="" class="form-control form-control-md" id="work_date" required>
            <div class="invalid-feedback">Пожалуйста, выберите дату</div>
          </div>
          <div class="modal-footer">
            <button name="approve_common_task" id="approve_common_task" value="True" type="button"
                    class="btn btn-success" onclick="addInTaskList()">Подтвердить</button>
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Отмена</button>
          </div>
        </div>
      </div>
    </div>

    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-success alert-dismissible fade show mx-0 mb-2 mt-0" role="alert">
            {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}

    <div  id="pool-table-container">
        <div class="text-center py-5">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="visually-hidden">Загрузка данных...</span>
            </div>
            <p class="mt-3">Идет загрузка таблицы...</p>
        </div>
    </div>
</div>

<script type="text/javascript" src="{% static 'js/common_pool.js' %}"></script>

{% endblock %}
</main>
