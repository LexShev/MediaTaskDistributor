{% extends  'main/index.html' %}

<main>
{% block body %}
  <div class="container-fluid text-start px-lg-5">
    <br><h4>Расширенный поиск:</h4><br>
    {% load static %}

    <form method="get" action="{% url 'advanced_search' %}" class="mx-lg-3" role="search">
    <div class="input-group mb-3">
        <label class="input-group-text" for="search_id">Поиск по</label>
    <!--    <select class="form-select" id="search_id" name="search_id">-->
    <!--      <option value="0">id</option>-->
    <!--      <option value="1" selected>названию</option>-->
    <!--      <option value="2">имени файла</option>-->
    <!--      <option value="3">исполнителю</option>-->
    <!--      <option value="4">дате эфира</option>-->
    <!--      <option value="5">крайнему сроку</option>-->
    <!--    </select>-->
    <!--    {{ form.search_id.label }}-->
        {{ form.search_id }}

        <input class="form-control" name="search_query" id="tableFilter" type="text" value="{% if search_query %}{{ search_query }}{% endif %}" placeholder="введите запрос ..." style="width: 100rem;">
        <button type="submit" class="btn btn-outline-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
            </svg>
        </button>
    </div>
    </form><br>


    <h5>Результатов: {{ search_list|length }}</h5>
    <hr width="100%" size="2"><br>
    {% if search_list %}
      {% for material in search_list %}
        <div class="card shadow mx-lg-3 my-2">
          <div class="card-header p-2">
            <div class="d-flex flex-wrap align-items-start">
              <div class="me-auto text-start">
                <a href="{% url 'home' %}{{ material.Progs_program_id }}" class="link-body-emphasis link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">
                  <h6 class="my-0 mx-1">{{ material.Progs_name }}{% if material.Progs_production_year %} ({{ material.Progs_production_year }}){% endif %}</h6>
                </a>
              </div>
              <div class="text-end">
                <small class="text-body-secondary my-0 mx-1">{{ material.Files_Name|dir_no_host_name }} - {{ material.Files_Size|convert_bytes:'b' }} - {{ material.Files_ModificationTime|date:"d.m.Y" }}</small>
              </div>
            </div>
          </div>
          <div class="card-body p-2">
            <div class="row">
              <div class="col">
                <p class="card-text m-0"><small class="text-body-secondary">Канал: </small>
                  <small class="text-body-primary">{{ material.SchedDay_schedule_id|schedule_name }}</small>
                </p>
              </div>
              <div class="col">
                <p class="card-text m-0"><small class="text-body-secondary">Возрастная категория: </small>
                  <small class="text-body-primary">{{ material.Adult_Name }}</small>
                </p>
              </div>
              <div class="col">
                <p class="card-text m-0"><small class="text-body-secondary">Дата отсмотра: </small>
                  <small class="text-body-primary">{{ material.work_date|date:"d E Y" }}</small>
                </p>
              </div>
              <div class="col">
                <p class="card-text m-0"><small class="text-body-secondary">
                Исполнитель: <a href="{% url 'home' %}worker/{{ material.Task_engineer_id }}" class="link-body-emphasis link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">
                {{ material.engineer_id|engineer_name }}</a></small>
                </p>
              </div>
              <div class="col">
                <p class="card-text m-0"><small class="text-body-secondary">Продолжительность: </small>
                  <small class="text-body-primary">{{ material.Progs_duration|convert_frames_to_time }}</small>
                </p>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  </div><br>

<script type="text/javascript" src="{% static 'js/advanced_search.js' %}"></script>
{% endblock %}
</main>